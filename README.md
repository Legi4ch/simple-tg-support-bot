# simple-tg-support-bot

## Простой чат бот Telegram для переписки с пользователями через web-интерфейс

### PHP и JS. Css фреймворк Materialize. Без внешних зависимостей.

### Подходит для быстрого запуска небольшой онлайн службы поддержки пользователей через телеграм.

Отлично для интернет-магазинов, различных сервисов услуг, персональных консультаций и т.д. 
Требует минимум настроек и может работать практически на любом хостинге с PHP.



__Что может?__

+ Пользователь пишет боту, оператор отвечает через веб-интерфейс. Пользователь получает ответ в бот.
+ Поддерживает несколько операторов в команде. Рекомендую 3, максимум 5. Выдержит и больше, но для большого количества обращений в бот и большего числа операторов, лучше использовать другие решения.
+ Бан пользователей (оскорбления, ругань и т.д.). Для пользователя бан прозрачен, то есть писать он сможет, но его сообщения не будут получены операторами.
+ Удаление чатов.
+ Пауза для оператора. Пока оператор на паузе, данные в его интерфейс приходить не будут.
+ Блокировка чат для оператора. Если оператор начал переписку с пользователем, то для других операторов этот чат будет не доступен.
+ В текущей версии поддерживается только получение и отправка фото. Отправка и получение файлов пока не поддерживается.



__Как работает?__

+ Скачиваете и размещаете проект на сайте
+ Регистрируете нового бота с помощью BotFather
+ настраиваете файл ```/config/Config.php``` 
+ обязательно укажите токен вашего бота, полученного от BotFather
+ выполняете на вашем сайте скрипт ```webhook_install.php```. Если все правильно, то ответом должно быть __*Webhook was set*__.
+ заводите операторов напрямую в файле базы данных в таблицу ```system_users```
+ *__можете общаться с пользователями через веб интерфейс__*



__Важно__

Рекомендую размещать файл базы данных в директории, куда веб-сервер не _смотрит_.
Или защищать его от скачивания напрямую, с помощью средств веб-сервера.
Директория, где размещается файл базы данных, а также сам файл базы, должны быть доступными для записи
пользователю, от имени которого запущен веб-сервер.

Также должны быть доступны для записи директории, в которые будут сохраняться фотографии и файлы, полученные 
от пользователй через бот.

Домен, на котором будет размещаться приложение, должен иметь SSL сертификат. Работа без SSL тоже возможна,
но такой опции из _коробки_ нет. 



__Особенности__

Из _коробки_ используется база SQLite для хранения. Может быть изменена на MysSql при необходимости.
Автоматической миграции не предусмотрено. Для смены базы необходимо будет создать таблицы вручную и произвести изменения
в файлах ```/config/Config.php```, ```/classes/Db.php```

В текущей версии нет возможности редактировать базу из веб интерфейса. Для добавления операторов 
необходимо вручную отредактировать файл базы с помощью программ для редактирования SQLite файлов.
Например, DB Browser for SQLite https://sqlitebrowser.org/.

Данные в интерфейсе обновляются через XMLHttpRequest запросы к серверу. Поэтому общение происходит не совсем в реальном времени. 
Обновления запрашиваются каждые 5 секунд. 
Эти значения могут быть изменены в настройках JS в файле ```/js/setting.js```

![preview](https://i.postimg.cc/BnW50Tv6/demo.jpg)
